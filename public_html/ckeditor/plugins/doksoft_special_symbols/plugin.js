var doksoftSpecialSymbolsUtils={pluginName:"doksoft_special_symbols",escapeHtml:function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");},getHtmlOfTemplate:function(e,a,b,f){var g="img";if(e[2]!==undefined){g=e[2];}var i="";if(e[3]!=undefined){i=e[3];}var d="";if(g=="img"){d='<img src="'+e[0]+'"/>';}else{if(g=="text"){var c=25;var j=15;j=f.config.doksoft_special_symbols_font_size;c=j+8;d='<div style="font-size:'+j+"px;line-height:"+c+"px;min-width:"+c+"px;min-height:"+c+'px;border:solid #CCC 1px;text-align:center;vertical-align:middle;cursor:pointer">'+e[0]+"</div>";}else{d=e[0];}}d='<div id="'+this.pluginName+"_template_"+a+'" class="'+this.pluginName+'_template" style="display:table-cell;float:left;"><div class="'+this.pluginName+'_template_html">'+d+"</div>";d+='<div class="'+this.pluginName+'_template_name" style="width:100%; max-width:100%; font-size:11px; text-align:center;'+(b?"":"display:none")+'">'+this.escapeHtml(i)+"</div>";d+="</div>";d=d.replace(/\{path\}/g,CKEDITOR.basePath+"plugins/"+this.pluginName);return d;},insertSelectedTemplate:function(h,d){var g=h.config.doksoft_special_symbols[d][1];if(Object.prototype.toString.call(g)==="[object Array]"){for(var f=0;f<g.length;f++){g[f]=g[f].replace(/\{path\}/g,CKEDITOR.basePath+"plugins/"+this.pluginName);}}else{g=g.replace(/\{path\}/g,CKEDITOR.basePath+"plugins/"+this.pluginName);}if(h.config.doksoft_special_symbols[d][2]=="text"){var e=document.getElementById(this.pluginName+"_use_image");if(e!=undefined&&e.checked){var j=document.getElementById(this.pluginName+"_font_name");var a=j[j.selectedIndex].value;var l=document.getElementById(this.pluginName+"_font_size").value;var b=g.substr(2,g.length-3);g='<img src="'+h.config.doksoft_special_symbols_images_generator_url+"?code="+b+"&font="+a+"&size="+l+'" alt="special symbol" title="special symbol" style="border-width:0"/>';var c=CKEDITOR.dom.element.createFromHtml(g);h.insertElement(c);}else{var k=h.document.createElement("span");k.setHtml(g);h.insertText(k.getText());}}else{if(h.config.doksoft_special_symbols[d][2]=="html_arr"){for(f=0;f<g.length;f++){var c=CKEDITOR.dom.element.createFromHtml(g[f]);h.insertElement(c);}}else{var c=CKEDITOR.dom.element.createFromHtml(g);h.insertElement(c);}}},readBooleanVar:function(b,a){if(b===undefined){b=a;}else{if(b!=a){b=!a;}}return b;},readIntVar:function(b,a){if(b===undefined){b=a;}return b;},readStringVar:function(b,a){if(b===undefined){b=a;}return b;},getIntCharCode:function(a){if(a.charAt(0)=="x"){a="0"+a;}if(a.charAt(0)=="0"&&a.charAt(1)=="x"){return parseInt(a,16);}else{return parseInt(a,10);}},};CKEDITOR.plugins.add(doksoftSpecialSymbolsUtils.pluginName,{lang:"en,ru",requires:["panelbutton","floatpanel"],icons:doksoftSpecialSymbolsUtils.pluginName,init:function(o){if(false){o.ui.addButton("doksoft_special_symbols",{command:"doksoft_special_symbols",icon:this.path+"icons/doksoft_special_symbols.png"});}if(typeof o.lang.doksoft_special_symbols.doksoft_special_symbols!="undefined"){o.lang.doksoft_special_symbols=o.lang.doksoft_special_symbols.doksoft_special_symbols;}o.config.doksoft_special_symbols_use_dialog=doksoftSpecialSymbolsUtils.readBooleanVar(o.config.doksoft_special_symbols_use_dialog,false);o.config.doksoft_special_symbols_popup_width=doksoftSpecialSymbolsUtils.readIntVar(o.config.doksoft_special_symbols_popup_width,550);o.config.doksoft_special_symbols=[];if(o.config.doksoft_special_symbols==undefined||(typeof o.config.doksoft_special_symbols=="array")||(typeof o.config.doksoft_special_symbols=="object")){o.config.doksoft_special_symbols="x2648-x2653,x2654-x265F,x2660-x2667,x2669-x266F,x20B3,x0E3F,xFFE0,x20A1,x00A2,x20A2,x20B5,x20AB,x20AC,xFFE1,x00A3,x20A4,x20A3,x0192,x20B2,x20AD,x20A5,x20A6,x20B1,xFF04,x0024,x20AE,x20A9,xFFE6,x00A5,xFFE5,x20B4,x00A4,x20B0,x20AA,x20AF,x20A0,x20A7,x0BF9,xFDFC,x3350,x09F2,x2701-x2704,x2706-x2709,x270C-x2727,x2729-x274B,x274F-x2752,x275B-x275E,x2781-x2793,x2190-x21EA,x00AB,x00BB,x275D-x275E,x00D7,x2030-x2031,x00A7,x00F7,x00B1,x203C,x00A1,x00BF,x2047,x2049,x2048,x203D,x00BC,x00BD,x00BE,x2155,x2159,x215B,x00B2,x00B3,x00A9,x00AE,x2122,x2120,x2260,x221A,x221B,x221C,x221E,x03B2,x03A6,x03A3,x20AC,x20A4,xFF40,xFF42,x2318,x2605";}if(o.config.doksoft_special_symbols_images_fonts==undefined){o.config.doksoft_special_symbols_images_fonts=["Universalia"];}o.config.doksoft_special_symbols_font_size=doksoftSpecialSymbolsUtils.readIntVar(o.config.doksoft_special_symbols_font_size,16);o.config.doksoft_special_symbols_images_allowed=doksoftSpecialSymbolsUtils.readBooleanVar(o.config.doksoft_special_symbols_images_allowed,true);o.config.doksoft_special_symbols_images_by_default=doksoftSpecialSymbolsUtils.readBooleanVar(o.config.doksoft_special_symbols_images_by_default,false);o.config.doksoft_special_symbols_images_font_default=doksoftSpecialSymbolsUtils.readStringVar(o.config.doksoft_special_symbols_images_font_default,"Serif");o.config.doksoft_special_symbols_images_font_size_default=doksoftSpecialSymbolsUtils.readIntVar(o.config.doksoft_special_symbols_images_font_size_default,12);
o.config.doksoft_special_symbols_images_generator_url=doksoftSpecialSymbolsUtils.readStringVar(o.config.doksoft_special_symbols_images_generator_url,CKEDITOR.basePath+"plugins/doksoft_special_symbols/gen.php");var n=[];var q=o.config.doksoft_special_symbols.split(",");for(var l=0;l<q.length;l++){var h=q[l];if(h.length==0){}else{if(h.length==1){n.push("&#"+h.charCodeAt(0)+";");}else{if(h.indexOf("-")==-1){n.push("&#"+doksoftSpecialSymbolsUtils.getIntCharCode(h)+";");}else{var d=h.split("-");var c=doksoftSpecialSymbolsUtils.getIntCharCode(d[0]);var k=doksoftSpecialSymbolsUtils.getIntCharCode(d[1]);for(var e=c;e<=k;e++){n.push("&#"+e+";");}}}}}o.config.doksoft_special_symbols=n;for(var l=0;l<o.config.doksoft_special_symbols.length;l++){var p=o.config.doksoft_special_symbols[l];o.config.doksoft_special_symbols[l]=[p,p,"text",""];}var j=function(b){return new o.dom.element(b,o.document);};var a=function(i){for(var b in i){return[b,i[b]];}};var m=0,g,s=-1,f=function(b){var y=document.getElementById(b);var x=y.getBoundingClientRect(),z=document.body,t=document.documentElement,i=window.pageYOffset||t.scrollTop||z.scrollTop,v=window.pageXOffset||t.scrollLeft||z.scrollLeft,w=t.clientTop||z.clientTop||0,A=t.clientLeft||z.clientLeft||0,B=x.top+i-w,u=x.left+v-A;return{top:Math.round(B),left:Math.round(u)};};o.on("instanceReady",function(b){var w='<div id="cke_'+doksoftSpecialSymbolsUtils.pluginName+"_"+o.name+'1" style="'+"overflow-y:scroll;padding:5px;"+(b.editor.config.doksoft_special_symbols_use_dialog?"max-height:500px;max-width:500px;height:500px;width:500px;border:1px solid gray":"max-height:500px;max-width:"+b.editor.config.doksoft_special_symbols_popup_width+"px;width:"+b.editor.config.doksoft_special_symbols_popup_width+"px;")+'">';if(b.editor.config.doksoft_special_symbols_images_allowed){w+='<div style="width:100%;padding-bottom:10px;font-size:13px">';w+='<input id="'+doksoftSpecialSymbolsUtils.pluginName+'_use_image" type="checkbox" '+(b.editor.config.doksoft_special_symbols_images_by_default?'checked="checked"':"")+"/>";w+="&nbsp;"+"As image";w+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+"Font name"+":&nbsp;";var v=0;for(var y=1;y<b.editor.config.doksoft_special_symbols_images_fonts.length;y++){if(b.editor.config.doksoft_special_symbols_images_fonts[y].toLowerCase()==b.editor.config.doksoft_special_symbols_images_font_default.toLowerCase()){v=y;}}w+='<select style="border:1px solid gray;width:150px" id="'+doksoftSpecialSymbolsUtils.pluginName+'_font_name">';for(var y=0;y<b.editor.config.doksoft_special_symbols_images_fonts.length;y++){w+='<option value="'+b.editor.config.doksoft_special_symbols_images_fonts[y]+'"'+(v==y?" selected":"")+">"+b.editor.config.doksoft_special_symbols_images_fonts[y]+"</option>";}w+="</select>";w+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+"Font size"+':&nbsp;<input style="border:1px solid gray;width:40px;padding:0" id="'+doksoftSpecialSymbolsUtils.pluginName+'_font_size" value="'+b.editor.config.doksoft_special_symbols_images_font_size_default+'"/> px';w+="</div>";}w+='<div style="width:100%;padding:0;margin:0">';for(var y=0;y<o.config.doksoft_special_symbols.length;y++){w+=doksoftSpecialSymbolsUtils.getHtmlOfTemplate(o.config.doksoft_special_symbols[y],y,false,b.editor);}w+="</div>";w+="</div>";m=document.createElement("div");m.setAttribute("id","cke_"+doksoftSpecialSymbolsUtils.pluginName+"_"+o.name);var z='<style type="text/css">.'+doksoftSpecialSymbolsUtils.pluginName+"_template:hover { outline: 1px silver solid; background: #EFEFFF; cursor:pointer} </style>";m.innerHTML=z+w;var t="cke_tpl_list_label_"+CKEDITOR.tools.getNextNumber();CKEDITOR.dialog.add(doksoftSpecialSymbolsUtils.pluginName,function(i){return{width:520,height:520,minWidth:520,maxHeight:520,resizable:0,title:i.lang[doksoftSpecialSymbolsUtils.pluginName].title,contents:[{id:"tab1",expand:true,focus:true,elements:[{type:"vbox",padding:10,children:[{id:"selectTpl",type:"html",html:"<div></div>",},],}],}],onLoad:function(){},onShow:function(){s=-1;if(!this.sdfsdf){var B=this.getContentElement("tab1","selectTpl");B.getElement().$.innerHtml="";B.getElement().$.appendChild(m);this.sdfsdf=1;}},onOk:function(){if(s>-1){doksoftSpecialSymbolsUtils.insertSelectedTemplate(b.editor,s);}}};});g=o.addCommand(doksoftSpecialSymbolsUtils.pluginName,new CKEDITOR.dialogCommand(doksoftSpecialSymbolsUtils.pluginName));if(!b.editor.config.doksoft_special_symbols_use_dialog){m.setAttribute("style","display:none;background:#fff; border:1px solid #ccc;padding:5px;position:absolute;");document.body.appendChild(m);}var x=m.getElementsByClassName(doksoftSpecialSymbolsUtils.pluginName+"_template"),A=function(F){var B=o.getSelection(),C=B.createBookmarks();var D=F||window.event;var E=this,i="";if(E.id&&(i=/^doksoft_special_symbols_template_([0-9]+)$/.exec(E.id))){!b.editor.config.doksoft_special_symbols_use_dialog&&(m.style.display="none");doksoftSpecialSymbolsUtils.insertSelectedTemplate(b.editor,i[1]);setTimeout(function(){o.focus();},10);}else{if(E.id!="cke_"+doksoftSpecialSymbolsUtils.pluginName+"_"+o.name&&E.id!="cke_"+doksoftSpecialSymbolsUtils.pluginName+"_"+o.name+"1"){!b.editor.config.doksoft_special_symbols_use_dialog&&(m.style.display="none");
}}},u=function(F){var E=this,B="";if(E.id&&(B=/^doksoft_special_symbols_template_([0-9]+)$/.exec(E.id))){var D=m.getElementsByClassName(doksoftSpecialSymbolsUtils.pluginName+"_template");for(var C=0;C<D.length;C++){if(D[C].id&&(/^doksoft_special_symbols_template_([0-9]+)$/.exec(D[C].id))){D[C].style.backgroundColor="#fff";}}E.style.backgroundColor="#9EC2F3";s=B[1];}};for(var y=0;y<x.length;y++){if(x[y].id&&(line=/^doksoft_special_symbols_template_([0-9]+)$/.exec(x[y].id))){x[y]["onmousedown"]=!b.editor.config.doksoft_special_symbols_use_dialog?A:u;b.editor.config.doksoft_special_symbols_use_dialog&&(x[y]["ondblclick"]=A);}}if(!b.editor.config.doksoft_special_symbols_use_dialog){o.document.$.addEventListener("mousedown",function(i){m.style.display="none";},false);window.addEventListener("mousedown",function(C){var i=C||window.event;var B=(i.srcElement||i.target);if(m.style.display=="block"&&B.id!=doksoftSpecialSymbolsUtils.pluginName+"_use_image"&&B.id!=doksoftSpecialSymbolsUtils.pluginName+"_font_name"&&B.id!=doksoftSpecialSymbolsUtils.pluginName+"_font_size"&&B.id!="cke_"+doksoftSpecialSymbolsUtils.pluginName+"_"+o.name&&B.id!="cke_"+doksoftSpecialSymbolsUtils.pluginName+"_"+o.name+"1"){m.style.display="none";}else{}},false);}});var r=0;if(!o.config.doksoft_special_symbols_use_dialog){o.ui.add(doksoftSpecialSymbolsUtils.pluginName,CKEDITOR.UI_PANELBUTTON,{label:o.lang[doksoftSpecialSymbolsUtils.pluginName].title,title:o.lang[doksoftSpecialSymbolsUtils.pluginName].title,modes:{wysiwyg:1},className:"cke_button_templates",panel:{attributes:{role:"listbox","aria-label":"ang.panelTitle"}},onBlock:function(b,i){window[doksoftSpecialSymbolsUtils.pluginName+"_"+o.name+"_button_id"]=this._.id;var t=f(this._.id);m.style.left=(t.left)+"px";m.style.top=(t.top+24)+"px";m.style.zIndex=(o.config.baseFloatZIndex+1);b.onShow=function(){id=window[doksoftSpecialSymbolsUtils.pluginName+"_"+o.name+"_button_id"];var u=f(id);this.element.setStyle("visibility","hidden");m.style.display="block";m.style.left=(u.left)+"px";m.style.top=(u.top+24)+"px";m.style.zIndex=(o.config.baseFloatZIndex+1);};},icon:this.path+"/icons/"+doksoftSpecialSymbolsUtils.pluginName+(CKEDITOR.version.charAt(0)=="4"?"_4":"")+".png",});}else{o.ui.addButton(doksoftSpecialSymbolsUtils.pluginName,{className:"cke_button_templates",label:o.lang[doksoftSpecialSymbolsUtils.pluginName].title,title:o.lang[doksoftSpecialSymbolsUtils.pluginName].title,icon:this.path+"/icons/"+doksoftSpecialSymbolsUtils.pluginName+(CKEDITOR.version.charAt(0)=="4"?"_4":"")+".png",command:doksoftSpecialSymbolsUtils.pluginName});}}});